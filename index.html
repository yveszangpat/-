<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</title>
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° jsPDF ‡πÅ‡∏•‡∏∞ html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Sarabun', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        .stat-label {
            color: #7f8c8d;
            font-size: 14px;
        }
        .job-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left: 5px solid #3498db;
        }
        .job-card.urgent {
            border-left-color: #e74c3c;
        }
        .job-card.in-progress {
            border-left-color: #f39c12;
        }
        .job-card.completed {
            border-left-color: #27ae60;
        }
        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .job-id {
            font-weight: bold;
            color: #2c3e50;
            font-size: 18px;
        }
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.pending { background: #ecf0f1; color: #7f8c8d; }
        .status.in-progress { background: #ffeaa7; color: #fd9801; }
        .status.completed { background: #d1f2eb; color: #27ae60; }
        .job-details {
            margin-bottom: 15px;
        }
        .detail-row {
            margin-bottom: 10px;
            display: flex;
            align-items: start;
        }
        .label {
            font-weight: bold;
            color: #34495e;
            min-width: 150px;
        }
        .value {
            flex: 1;
            padding-left: 10px;
        }
        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #3498db;
            color: white;
        }
        .btn-success {
            background: #27ae60;
            color: white;
        }
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        .btn-test {
            background: #9b59b6;
            color: white;
        }
        .btn:hover {
            opacity: 0.8;
        }
        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab {
            padding: 10px 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        .tab:hover {
            background: #3498db;
            color: white;
        }
        .loading {
            text-align: center;
            padding: 20px;
            font-size: 18px;
        }
        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .refresh-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        /* PDF Form Styles */
        .pdf-form {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #000;
            font-family: 'Sarabun', Arial, sans-serif;
            font-size: 14px;
            line-height: 1.4;
            color: #000;
        }
        .pdf-form h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .pdf-form .form-row {
            display: flex;
            margin-bottom: 15px;
            align-items: center;
        }
        .pdf-form .form-field {
            margin-right: 20px;
        }
        .pdf-form .form-field label {
            margin-right: 5px;
        }
        .pdf-form .form-field input {
            border: none;
            border-bottom: 1px solid #000;
            padding: 2px;
            min-width: 100px;
        }
        .pdf-form .form-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #000;
        }
        .pdf-form .form-section h3 {
            margin-top: 0;
            font-size: 16px;
            font-weight: bold;
        }
        .pdf-form .checkbox-group {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }
        .pdf-form .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .pdf-form .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .pdf-form .signature-box {
            text-align: center;
            padding: 20px;
            border: 1px solid #000;
            min-width: 200px;
        }
        .pdf-form .long-input {
            width: 100%;
            min-height: 60px;
            border: 1px solid #000;
            padding: 5px;
            resize: vertical;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: #000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</h1>
            <p>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏à‡∏≤‡∏Å Google Forms</p>
        </div>

        <div class="stats" id="stats">
            <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>

        <div class="filter-tabs">
            <div class="tab active" data-filter="all">üìã ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            <div class="tab" data-filter="pending">‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            <div class="tab" data-filter="in-progress">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            <div class="tab" data-filter="completed">‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
        </div>

        <div style="margin-bottom: 20px;">
            <button class="btn btn-test" onclick="loadData()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button class="btn btn-test" onclick="toggleDebug()">üîç ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Debug</button>
        </div>

        <div id="debug-info" class="debug-info" style="display: none;">
            <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• debug ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>

        <div id="loading" class="loading" style="display: none;">
            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
        </div>

        <div id="error" class="error" style="display: none;">
            <!-- ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>

        <div id="jobs-container">
            <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>
    </div>

    <button class="refresh-btn" onclick="loadData()" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
        üîÑ
    </button>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° PDF -->
    <div id="pdfModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° / ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
                <span class="close" onclick="closePDFModal()">&times;</span>
            </div>
            <div id="pdfContent">
                <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏° PDF ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="downloadPDF()">üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</button>
                <button class="btn btn-danger" onclick="closePDFModal()">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>
    </div>

    <script>
        // ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets API
        const API_KEY = 'AIzaSyDCYbEzSRemuRTXnRn2fRUikshM4dS3QHA';
        const SHEET_ID = '1UJfjQKJfLFMIlj2BNCtfrVyDHBYx32e4o0fGo_JQm1I';
        const RANGE = 'Form Responses 1!A:Z';

        let allJobs = [];
        let currentFilter = 'all';
        let debugMode = false;
        let currentJobForPDF = null;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• debug
        function showDebug(message, data = null) {
            if (!debugMode) return;
            
            const debugEl = document.getElementById('debug-info');
            const timestamp = new Date().toLocaleTimeString('th-TH');
            const debugMessage = `[${timestamp}] ${message}`;
            
            console.log(debugMessage, data);
            
            debugEl.innerHTML += `
                <div style="margin-bottom: 5px; padding: 5px; background: #e9ecef; border-radius: 3px;">
                    <strong>${debugMessage}</strong>
                    ${data ? `<pre style="margin: 5px 0; font-size: 11px;">${JSON.stringify(data, null, 2)}</pre>` : ''}
                </div>
            `;
            
            debugEl.scrollTop = debugEl.scrollHeight;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î debug
        function toggleDebug() {
            debugMode = !debugMode;
            const debugEl = document.getElementById('debug-info');
            debugEl.style.display = debugMode ? 'block' : 'none';
            
            if (debugMode) {
                showDebug('‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î Debug');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
        async function fetchJobsFromGoogleSheets() {
            showDebug('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets...');
            
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                showDebug('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏à‡∏≤‡∏Å Google Sheets:', data);
                
                if (!data.values || data.values.length <= 1) {
                    showDebug('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô Google Sheets');
                    return [];
                }
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á
                const jobs = data.values.slice(1).map((row, index) => {
                    const job = {
                        id: index + 1,
                        timestamp: row[0] || '',           // Timestamp
                        type: row[1] || '',               // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á
                        date: row[2] || '',               // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á
                        time: row[3] || '',               // ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á
                        building: row[4] || '',           // ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£
                        floor: row[5] || '',              // ‡∏ä‡∏±‡πâ‡∏ô
                        department: row[6] || '',         // ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
                        phone: row[7] || '',              // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
                        description: row[8] || '',        // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°
                        reporter: row[9] || '',           // ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
                        receiver: row[10] || '',          // ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á
                        supervisor: row[11] || '',        // ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
                        status: row[12] || 'pending',     // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                        assignedTo: row[13] || '',        // ‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô
                        repairResult: row[14] || '',      // ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°
                        repairDetails: row[15] || '',     // ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°
                        equipment: row[16] || '',         // ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
                        completedDate: row[17] || ''      // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
                    };
                    
                    // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
                    if (job.reporter && job.description) {
                        return job;
                    }
                    return null;
                }).filter(job => job !== null);
                
                showDebug(`‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô: ${jobs.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`, jobs);
                return jobs;
                
            } catch (error) {
                showDebug('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error.message);
                throw error;
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
        function displayStats(jobs) {
            const stats = {
                total: jobs.length,
                pending: jobs.filter(j => j.status === 'pending').length,
                inProgress: jobs.filter(j => j.status === 'in-progress').length,
                completed: jobs.filter(j => j.status === 'completed').length
            };

            const statsHtml = `
                <div class="stat-card">
                    <div class="stat-number">${stats.total}</div>
                    <div class="stat-label">‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.pending}</div>
                    <div class="stat-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.inProgress}</div>
                    <div class="stat-label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.completed}</div>
                    <div class="stat-label">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div>
                </div>
            `;

            document.getElementById('stats').innerHTML = statsHtml;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô
        function displayJobs(jobs) {
            const container = document.getElementById('jobs-container');
            
            if (jobs.length === 0) {
                container.innerHTML = '<div class="loading">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</div>';
                return;
            }

            container.innerHTML = '';

            jobs.forEach(job => {
                const jobCard = document.createElement('div');
                jobCard.className = `job-card ${job.status}`;
                jobCard.innerHTML = `
                    <div class="job-header">
                        <span class="job-id">‡∏á‡∏≤‡∏ô #${job.id}</span>
                        <span class="status ${job.status}">
                            ${getStatusText(job.status)}
                        </span>
                    </div>
                    <div class="job-details">
                        <div class="detail-row">
                            <span class="label">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á:</span>
                            <span class="value">${job.date} ${job.time}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üè¢ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á:</span>
                            <span class="value">${job.type}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üè¢ ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£:</span>
                            <span class="value">${job.building}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üè¢ ‡∏ä‡∏±‡πâ‡∏ô:</span>
                            <span class="value">${job.floor}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üè¢ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô:</span>
                            <span class="value">${job.department}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</span>
                            <span class="value">${job.phone}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üë§ ‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</span>
                            <span class="value">${job.reporter}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üìù ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</span>
                            <span class="value">${job.description}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üë§ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á:</span>
                            <span class="value">${job.receiver}</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">üë§ ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô:</span>
                            <span class="value">${job.supervisor}</span>
                        </div>
                        ${job.assignedTo ? `
                        <div class="detail-row">
                            <span class="label">üë∑ ‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô:</span>
                            <span class="value">${job.assignedTo}</span>
                        </div>
                        ` : ''}
                        ${job.repairResult ? `
                        <div class="detail-row">
                            <span class="label">‚úÖ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°:</span>
                            <span class="value">${job.repairResult}</span>
                        </div>
                        ` : ''}
                        ${job.repairDetails ? `
                        <div class="detail-row">
                            <span class="label">üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°:</span>
                            <span class="value">${job.repairDetails}</span>
                        </div>
                        ` : ''}
                    </div>
                    <div class="actions">
                        ${getActionButtons(job)}
                    </div>
                `;
                container.appendChild(jobCard);
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
        function getStatusText(status) {
            const statusMap = {
                'pending': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                'in-progress': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                'completed': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô'
            };
            return statusMap[status] || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function getActionButtons(job) {
            let buttons = `<button class="btn btn-info" onclick="generatePDF(${job.id})">üìÑ ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF</button>`;
            
            if (job.status === 'pending') {
                buttons += `<button class="btn btn-primary" onclick="acceptJob(${job.id})">ü§ù ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô</button>`;
            } else if (job.status === 'in-progress') {
                buttons += `<button class="btn btn-success" onclick="completeJob(${job.id})">‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</button>`;
            }
            
            return buttons;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° PDF
        function generatePDF(jobId) {
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;
            
            currentJobForPDF = job;
            
            const pdfContent = `
                <div class="pdf-form" id="pdfForm">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h2>‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° / ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
                        <p><strong>‡∏á‡∏≤‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</strong></p>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</label>
                            <input type="text" value="${job.id}" readonly>
                        </div>
                        <div class="form-field">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                            <input type="text" value="${job.date}" readonly>
                        </div>
                        <div class="form-field">
                            <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á:</label>
                            <input type="text" value="${job.time}" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label>‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£:</label>
                            <input type="text" value="${job.building}" readonly>
                        </div>
                        <div class="form-field">
                            <label>‡∏ä‡∏±‡πâ‡∏ô:</label>
                            <input type="text" value="${job.floor}" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</label>
                            <input type="text" value="${job.department}" readonly>
                        </div>
                        <div class="form-field">
                            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ:</label>
                            <input type="text" value="${job.phone}" readonly>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <label><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°:</strong></label>
                        <textarea class="long-input" readonly>${job.description}</textarea>
                    </div>
                    
                    <div class="signature-section">
                        <div class="signature-box">
                            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................ ‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                            <p>( ${job.reporter} )</p>
                        </div>
                        <div class="signature-box">
                            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................ ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</p>
                            <p>( ${job.receiver} )</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <div class="signature-box">
                            <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................ ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á</p>
                            <p>( ${job.supervisor} )</p>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á</h3>
                        
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" ${job.repairResult === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' ? 'checked' : ''}>
                                <label>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" ${job.repairResult === '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ' ? 'checked' : ''}>
                                <label>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ</label>
                            </div>
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <label><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á:</strong></label>
                            <textarea class="long-input">${job.repairDetails}</textarea>
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <label><strong>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:</strong></label>
                            <textarea class="long-input">${job.equipment}</textarea>
                        </div>
                        
                        <div style="margin: 15px 0;">
                            <label><strong>*** ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ã‡πà‡∏≠‡∏°‡πÑ‡∏î‡πâ:</strong></label>
                            <textarea class="long-input"></textarea>
                        </div>
                        
                        <div class="signature-section">
                            <div class="signature-box">
                                <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................ ‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</p>
                                <p>( ${job.assignedTo} )</p>
                                <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${job.completedDate}</p>
                            </div>
                            <div class="signature-box">
                                <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................ ‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</p>
                                <p>( ${job.reporter} )</p>
                                <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ...........................</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('pdfContent').innerHTML = pdfContent;
            document.getElementById('pdfModal').style.display = 'block';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î Modal
        function closePDFModal() {
            document.getElementById('pdfModal').style.display = 'none';
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            const pdfElement = document.getElementById('pdfForm');
            
            html2canvas(pdfElement, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                const job = currentJobForPDF;
                const fileName = `‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°_${job.id}_${job.reporter}_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                closePDFModal();
            }).catch(error => {
                console.error('Error generating PDF:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PDF');
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function filterJobs(status) {
            currentFilter = status;
            const filteredJobs = status === 'all' 
                ? allJobs 
                : allJobs.filter(job => job.status === status);
            
            displayJobs(filteredJobs);
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô
        function acceptJob(jobId) {
            const technicianName = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô:');
            if (technicianName) {
                const job = allJobs.find(j => j.id === jobId);
                if (job) {
                    job.status = 'in-progress';
                    job.assignedTo = technicianName;
                    displayJobs(currentFilter === 'all' ? allJobs : allJobs.filter(j => j.status === currentFilter));
                    displayStats(allJobs);
                    alert('‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
                }
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô
        function completeJob(jobId) {
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;
            
            // ‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô
            const repairDetails = prompt('‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á:');
            const equipment = prompt('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:');
            
            if (repairDetails) {
                job.status = 'completed';
                job.repairResult = '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô';
                job.repairDetails = repairDetails;
                job.equipment = equipment || '';
                job.completedDate = new Date().toLocaleDateString('th-TH');
                
                displayJobs(currentFilter === 'all' ? allJobs : allJobs.filter(j => j.status === currentFilter));
                displayStats(allJobs);
                alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        async function loadData() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            
            try {
                const jobs = await fetchJobsFromGoogleSheets();
                allJobs = jobs;
                displayStats(allJobs);
                filterJobs(currentFilter);
                loadingEl.style.display = 'none';
                
                showDebug(`‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô: ${jobs.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                
            } catch (error) {
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                errorEl.innerHTML = `
                    <strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</strong> ${error.message}<br>
                    <small>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</small>
                `;
                showDebug('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error.message);
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ tab filters
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    filterJobs(this.dataset.filter);
                });
            });

            // ‡∏õ‡∏¥‡∏î modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
            window.onclick = function(event) {
                const modal = document.getElementById('pdfModal');
                if (event.target === modal) {
                    closePDFModal();
                }
            };

            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
            loadData();
        });

        // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setInterval(loadData, 30000);
    </script>
</body>
</html>